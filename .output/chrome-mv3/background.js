var background=function(){"use strict";function xe(e){return e==null||typeof e=="function"?{main:e}:e}var oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function K(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Y={exports:{}};const pe=e=>typeof crypto<"u"&&typeof crypto.getRandomValues=="function"?()=>{const s=crypto.getRandomValues(new Uint8Array(1))[0];return(s>=e?s%e:s).toString(e)}:()=>Math.floor(Math.random()*e).toString(e),ie=(e=7,s=!1)=>Array.from({length:e},pe(s?16:36)).join("");Y.exports=ie,Y.exports.default=ie;var be=Y.exports;const z=K(be);var he=()=>`uid::${z(7)}`,we=(e,s=["endpointName","fingerprint"])=>typeof e=="object"&&e!==null&&s.every(r=>r in e),ye=e=>{try{const s=JSON.parse(e);return we(s)?s:null}catch{return null}},ve=()=>{let e=[];return{add:(...s)=>{e=[...e,...s]},remove:s=>{e=typeof s=="string"?e.filter(r=>r.message.transactionId!==s):e.filter(r=>!s.includes(r))},entries:()=>e}},W=class{static toBackground(e,s){return e.postMessage(s)}static toExtensionContext(e,s){return e.postMessage(s)}},ke=Object.defineProperty,Ce=Object.defineProperties,Ee=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable,ge=(e,s,r)=>s in e?ke(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,$=(e,s)=>{for(var r in s||(s={}))Te.call(s,r)&&ge(e,r,s[r]);if(ae)for(var r of ae(s))Se.call(s,r)&&ge(e,r,s[r]);return e},Q=(e,s)=>Ce(e,Ee(s)),_e=/^((?:background$)|devtools|popup|options|content-script|window)(?:@(\d+)(?:\.(\d+))?)?$/,X=e=>{const[,s,r,u]=e.match(_e)||[];return{context:s,tabId:+r,frameId:u?+u:void 0}},G=({context:e,tabId:s,frameId:r})=>["background","popup","options"].includes(e)?e:`${e}@${s}${r?`.${r}`:""}`;const Pe=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],ee=Symbol(".toJSON was called"),Me=e=>{e[ee]=!0;const s=e.toJSON();return delete e[ee],s},me=({from:e,seen:s,to_:r,forceEnumerable:u,maxDepth:d,depth:i})=>{const o=r||(Array.isArray(e)?[]:{});if(s.push(e),i>=d)return o;if(typeof e.toJSON=="function"&&e[ee]!==!0)return Me(e);for(const[a,x]of Object.entries(e)){if(typeof Buffer=="function"&&Buffer.isBuffer(x)){o[a]="[object Buffer]";continue}if(x!==null&&typeof x=="object"&&typeof x.pipe=="function"){o[a]="[object Stream]";continue}if(typeof x!="function"){if(!x||typeof x!="object"){o[a]=x;continue}if(!s.includes(e[a])){i++,o[a]=me({from:e[a],seen:[...s],forceEnumerable:u,maxDepth:d,depth:i});continue}o[a]="[Circular]"}}for(const{property:a,enumerable:x}of Pe)typeof e[a]=="string"&&Object.defineProperty(o,a,{value:e[a],enumerable:u?!0:x,configurable:!0,writable:!0});return o};function Ie(e,s={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=s;return typeof e=="object"&&e!==null?me({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}let le=()=>({events:{},emit(e,...s){(this.events[e]||[]).forEach(r=>r(...s))},on(e,s){return(this.events[e]=this.events[e]||[]).push(s),()=>this.events[e]=(this.events[e]||[]).filter(r=>r!==s)}});var Ne=(e,s,r)=>{const u=z(),d=new Map,i=new Map,o=a=>{if(a.destination.context===e&&!a.destination.frameId&&!a.destination.tabId){r==null||r(a);const{transactionId:x,messageID:k,messageType:b}=a,_=()=>{const v=d.get(x);if(v){const{err:w,data:T}=a;if(w){const S=w,F=self[S.name],D=new(typeof F=="function"?F:Error)(S.message);for(const O in S)D[O]=S[O];v.reject(D)}else v.resolve(T);d.delete(x)}},I=async()=>{let v,w,T=!1;try{const S=i.get(k);if(typeof S=="function")v=await S({sender:a.origin,id:k,data:a.data,timestamp:a.timestamp});else throw T=!0,new Error(`[webext-bridge] No handler registered in '${e}' to accept messages with id '${k}'`)}catch(S){w=S}finally{if(w&&(a.err=Ie(w)),o(Q($({},a),{messageType:"reply",data:v,origin:{context:e,tabId:null},destination:a.origin,hops:[]})),w&&!T)throw v}};switch(b){case"reply":return _();case"message":return I()}}return a.hops.push(`${e}::${u}`),s(a)};return{handleMessage:o,endTransaction:a=>{const x=d.get(a);x==null||x.reject("Transaction was ended before it could complete"),d.delete(a)},sendMessage:(a,x,k="background")=>{const b=typeof k=="string"?X(k):k,_="Bridge#sendMessage ->";if(!b.context)throw new TypeError(`${_} Destination must be any one of known destinations`);return new Promise((I,v)=>{const w={messageID:a,data:x,destination:b,messageType:"message",transactionId:z(),origin:{context:e,tabId:null},hops:[],timestamp:Date.now()};d.set(w.transactionId,{resolve:I,reject:v});try{o(w)}catch(T){d.delete(w.transactionId),v(T)}})},onMessage:(a,x)=>(i.set(a,x),()=>i.delete(a))}},L=class{constructor(e,s){this.endpointRuntime=e,this.streamInfo=s,this.emitter=le(),this.isClosed=!1,this.handleStreamClose=()=>{this.isClosed||(this.isClosed=!0,this.emitter.emit("closed",!0),this.emitter.events={})},L.initDone||(e.onMessage("__crx_bridge_stream_transfer__",r=>{const{streamId:u,streamTransfer:d,action:i}=r.data,o=L.openStreams.get(u);o&&!o.isClosed&&(i==="transfer"&&o.emitter.emit("message",d),i==="close"&&(L.openStreams.delete(u),o.handleStreamClose()))}),L.initDone=!0),L.openStreams.set(this.streamInfo.streamId,this)}get info(){return this.streamInfo}send(e){if(this.isClosed)throw new Error("Attempting to send a message over closed stream. Use stream.onClose(<callback>) to keep an eye on stream status");this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:e,action:"transfer"},this.streamInfo.endpoint)}close(e){e&&this.send(e),this.handleStreamClose(),this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:null,action:"close"},this.streamInfo.endpoint)}onMessage(e){return this.getDisposable("message",e)}onClose(e){return this.getDisposable("closed",e)}getDisposable(e,s){const r=this.emitter.on(e,s);return Object.assign(r,{dispose:r,close:r})}},V=L;V.initDone=!1,V.openStreams=new Map;var Re=e=>{const s=new Map,r=new Map,u=le();e.onMessage("__crx_bridge_stream_open__",o=>new Promise(a=>{const{sender:x,data:k}=o,{channel:b}=k;let _=!1,I=()=>{};const v=()=>{const w=r.get(b);typeof w=="function"?(w(new V(e,Q($({},k),{endpoint:x}))),_&&I(),a(!0)):_||(_=!0,I=u.on("did-change-stream-callbacks",v))};v()}));async function d(o,a){if(s.has(o))throw new Error("webext-bridge: A Stream is already open at this channel");const x=typeof a=="string"?X(a):a,k={streamId:z(),channel:o,endpoint:x},b=new V(e,k);return b.onClose(()=>s.delete(o)),await e.sendMessage("__crx_bridge_stream_open__",k,x),s.set(o,b),b}function i(o,a){if(r.has(o))throw new Error("webext-bridge: This channel has already been claimed. Stream allows only one-on-one communication");r.set(o,a),u.emit("did-change-stream-callbacks")}return{openStream:d,onOpenStreamChannel:i}},ce={exports:{}};(function(e,s){(function(r,u){u(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:oe,function(r){if(typeof globalThis!="object"||typeof chrome!="object"||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const u="The message port closed before a response was received.",d="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",i=o=>{const a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(a).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class x extends WeakMap{constructor(t,c=void 0){super(c),this.createItem=t}get(t){return this.has(t)||this.set(t,this.createItem(t)),super.get(t)}}const k=n=>n&&typeof n=="object"&&typeof n.then=="function",b=(n,t)=>(...c)=>{o.runtime.lastError?n.reject(new Error(o.runtime.lastError.message)):t.singleCallbackArg||c.length<=1&&t.singleCallbackArg!==!1?n.resolve(c[0]):n.resolve(c)},_=n=>n==1?"argument":"arguments",I=(n,t)=>function(f,...p){if(p.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${_(t.minArgs)} for ${n}(), got ${p.length}`);if(p.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${_(t.maxArgs)} for ${n}(), got ${p.length}`);return new Promise((A,h)=>{if(t.fallbackToNoCallback)try{f[n](...p,b({resolve:A,reject:h},t))}catch(g){console.warn(`${n} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,g),f[n](...p),t.fallbackToNoCallback=!1,t.noCallback=!0,A()}else t.noCallback?(f[n](...p),A()):f[n](...p,b({resolve:A,reject:h},t))})},v=(n,t,c)=>new Proxy(t,{apply(f,p,A){return c.call(p,n,...A)}});let w=Function.call.bind(Object.prototype.hasOwnProperty);const T=(n,t={},c={})=>{let f=Object.create(null),p={has(h,g){return g in n||g in f},get(h,g,C){if(g in f)return f[g];if(!(g in n))return;let y=n[g];if(typeof y=="function")if(typeof t[g]=="function")y=v(n,n[g],t[g]);else if(w(c,g)){let E=I(g,c[g]);y=v(n,n[g],E)}else y=y.bind(n);else if(typeof y=="object"&&y!==null&&(w(t,g)||w(c,g)))y=T(y,t[g],c[g]);else if(w(c,"*"))y=T(y,t[g],c["*"]);else return Object.defineProperty(f,g,{configurable:!0,enumerable:!0,get(){return n[g]},set(E){n[g]=E}}),y;return f[g]=y,y},set(h,g,C,y){return g in f?f[g]=C:n[g]=C,!0},defineProperty(h,g,C){return Reflect.defineProperty(f,g,C)},deleteProperty(h,g){return Reflect.deleteProperty(f,g)}},A=Object.create(n);return new Proxy(A,p)},S=n=>({addListener(t,c,...f){t.addListener(n.get(c),...f)},hasListener(t,c){return t.hasListener(n.get(c))},removeListener(t,c){t.removeListener(n.get(c))}}),F=new x(n=>typeof n!="function"?n:function(c){const f=T(c,{},{getContent:{minArgs:0,maxArgs:0}});n(f)});let D=!1;const O=new x(n=>typeof n!="function"?n:function(c,f,p){let A=!1,h,g=new Promise(R=>{h=function(N){D||(console.warn(d,new Error().stack),D=!0),A=!0,R(N)}}),C;try{C=n(c,f,h)}catch(R){C=Promise.reject(R)}const y=C!==!0&&k(C);if(C!==!0&&!y&&!A)return!1;const E=R=>{R.then(N=>{p(N)},N=>{let te;N&&(N instanceof Error||typeof N.message=="string")?te=N.message:te="An unexpected error occurred",p({__mozWebExtensionPolyfillReject__:!0,message:te})}).catch(N=>{console.error("Failed to send onMessage rejected reply",N)})};return E(y?C:g),!0}),ne=({reject:n,resolve:t},c)=>{o.runtime.lastError?o.runtime.lastError.message===u?t():n(new Error(o.runtime.lastError.message)):c&&c.__mozWebExtensionPolyfillReject__?n(new Error(c.message)):t(c)},U=(n,t,c,...f)=>{if(f.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${_(t.minArgs)} for ${n}(), got ${f.length}`);if(f.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${_(t.maxArgs)} for ${n}(), got ${f.length}`);return new Promise((p,A)=>{const h=ne.bind(null,{resolve:p,reject:A});f.push(h),c.sendMessage(...f)})},m={devtools:{network:{onRequestFinished:S(F)}},runtime:{onMessage:S(O),onMessageExternal:S(O),sendMessage:U.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:U.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},l={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":l},services:{"*":l},websites:{"*":l}},T(o,m,a)};r.exports=i(chrome)}else r.exports=globalThis.browser})})(ce);var $e=ce.exports;const Oe=K($e);var q=ve(),P=new Map,B=new Map,Z=new Map,Ae=(e,s)=>(B.set(e,(B.get(e)||new Set).add(s)),()=>{const r=B.get(e);r!=null&&r.delete(s)&&(r==null?void 0:r.size)===0&&B.delete(e)}),ue=(e,s)=>{Z.set(e,(Z.get(e)||new Set).add(s))},j=e=>({withFingerprint:s=>{const r=d=>({and:()=>d}),u={aboutIncomingMessage:d=>{const i=P.get(e);return W.toExtensionContext(i.port,{status:"incoming",message:d}),r(u)},aboutSuccessfulDelivery:d=>{const i=P.get(e);return W.toExtensionContext(i.port,{status:"delivered",receipt:d}),r(u)},aboutMessageUndeliverability:(d,i)=>{const o=P.get(e);return(o==null?void 0:o.fingerprint)===s&&W.toExtensionContext(o.port,{status:"undeliverable",resolvedDestination:d,message:i}),r(u)},whenDeliverableTo:d=>{const i=()=>{const o=P.get(e);if((o==null?void 0:o.fingerprint)===s&&P.has(d))return W.toExtensionContext(o.port,{status:"deliverable",deliverableTo:d}),!0};if(!i()){const o=Ae(d,i);ue(s,o)}return r(u)},aboutSessionEnded:d=>{const i=P.get(e);return(i==null?void 0:i.fingerprint)===s&&W.toExtensionContext(i.port,{status:"terminated",fingerprint:d}),r(u)}};return u}}),je=he(),J=Ne("background",e=>{var s;if(e.origin.context==="background"&&["content-script","devtools "].includes(e.destination.context)&&!e.destination.tabId)throw new TypeError("When sending messages from background page, use @tabId syntax to target specific tab");const r=G($($({},e.origin),e.origin.context==="window"&&{context:"content-script"})),u=G(Q($($({},e.destination),e.destination.context==="window"&&{context:"content-script"}),{tabId:e.destination.tabId||e.origin.tabId}));e.destination.tabId=null,e.destination.frameId=null;const d=()=>P.get(u),i=()=>P.get(r),o=()=>{var a;j(u).withFingerprint(d().fingerprint).aboutIncomingMessage(e);const x={message:e,to:d().fingerprint,from:{endpointId:r,fingerprint:(a=i())==null?void 0:a.fingerprint}};e.messageType==="message"&&q.add(x),e.messageType==="reply"&&q.remove(e.messageID),i()&&j(r).withFingerprint(i().fingerprint).aboutSuccessfulDelivery(x)};(s=d())!=null&&s.port?o():e.messageType==="message"&&(e.origin.context==="background"?Ae(u,o):i()&&j(r).withFingerprint(i().fingerprint).aboutMessageUndeliverability(u,e).and().whenDeliverableTo(u))},e=>{const s=G($($({},e.origin),e.origin.context==="window"&&{context:"content-script"})),r=P.get(s),u={message:e,to:je,from:{endpointId:s,fingerprint:r.fingerprint}};j(s).withFingerprint(r.fingerprint).aboutSuccessfulDelivery(u)});Oe.runtime.onConnect.addListener(e=>{var s;const r=ye(e.name);if(!r)return;r.endpointName||(r.endpointName=G({context:"content-script",tabId:e.sender.tab.id,frameId:e.sender.frameId}));const{tabId:u,frameId:d}=X(r.endpointName);P.set(r.endpointName,{fingerprint:r.fingerprint,port:e}),(s=B.get(r.endpointName))==null||s.forEach(i=>i()),B.delete(r.endpointName),ue(r.fingerprint,()=>{const i=q.entries().filter(o=>o.to===r.fingerprint);q.remove(i),i.forEach(o=>{o.from.endpointId==="background"?J.endTransaction(o.message.transactionId):j(o.from.endpointId).withFingerprint(o.from.fingerprint).aboutSessionEnded(r.fingerprint)})}),e.onDisconnect.addListener(()=>{var i,o;((i=P.get(r.endpointName))==null?void 0:i.fingerprint)===r.fingerprint&&P.delete(r.endpointName),(o=Z.get(r.fingerprint))==null||o.forEach(a=>a()),Z.delete(r.fingerprint)}),e.onMessage.addListener(i=>{var o,a;if(i.type==="sync"){const x=[...P.values()].map(b=>b.fingerprint),k=i.pendingResponses.filter(b=>x.includes(b.to));q.add(...k),i.pendingResponses.filter(b=>!x.includes(b.to)).forEach(b=>j(r.endpointName).withFingerprint(r.fingerprint).aboutSessionEnded(b.to)),i.pendingDeliveries.forEach(b=>j(r.endpointName).withFingerprint(r.fingerprint).whenDeliverableTo(b));return}i.type==="deliver"&&((a=(o=i.message)==null?void 0:o.origin)!=null&&a.context)&&(i.message.origin.tabId=u,i.message.origin.frameId=d,J.handleMessage(i.message))})});var{sendMessage:We,onMessage:de}=J;Re(J);var fe={exports:{}};(function(e,s){(function(r,u){u(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:oe,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const u="The message port closed before a response was received.",d=i=>{const o={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(o).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(l,n=void 0){super(n),this.createItem=l}get(l){return this.has(l)||this.set(l,this.createItem(l)),super.get(l)}}const x=m=>m&&typeof m=="object"&&typeof m.then=="function",k=(m,l)=>(...n)=>{i.runtime.lastError?m.reject(new Error(i.runtime.lastError.message)):l.singleCallbackArg||n.length<=1&&l.singleCallbackArg!==!1?m.resolve(n[0]):m.resolve(n)},b=m=>m==1?"argument":"arguments",_=(m,l)=>function(t,...c){if(c.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${b(l.minArgs)} for ${m}(), got ${c.length}`);if(c.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${b(l.maxArgs)} for ${m}(), got ${c.length}`);return new Promise((f,p)=>{if(l.fallbackToNoCallback)try{t[m](...c,k({resolve:f,reject:p},l))}catch(A){console.warn(`${m} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,A),t[m](...c),l.fallbackToNoCallback=!1,l.noCallback=!0,f()}else l.noCallback?(t[m](...c),f()):t[m](...c,k({resolve:f,reject:p},l))})},I=(m,l,n)=>new Proxy(l,{apply(t,c,f){return n.call(c,m,...f)}});let v=Function.call.bind(Object.prototype.hasOwnProperty);const w=(m,l={},n={})=>{let t=Object.create(null),c={has(p,A){return A in m||A in t},get(p,A,h){if(A in t)return t[A];if(!(A in m))return;let g=m[A];if(typeof g=="function")if(typeof l[A]=="function")g=I(m,m[A],l[A]);else if(v(n,A)){let C=_(A,n[A]);g=I(m,m[A],C)}else g=g.bind(m);else if(typeof g=="object"&&g!==null&&(v(l,A)||v(n,A)))g=w(g,l[A],n[A]);else if(v(n,"*"))g=w(g,l[A],n["*"]);else return Object.defineProperty(t,A,{configurable:!0,enumerable:!0,get(){return m[A]},set(C){m[A]=C}}),g;return t[A]=g,g},set(p,A,h,g){return A in t?t[A]=h:m[A]=h,!0},defineProperty(p,A,h){return Reflect.defineProperty(t,A,h)},deleteProperty(p,A){return Reflect.deleteProperty(t,A)}},f=Object.create(m);return new Proxy(f,c)},T=m=>({addListener(l,n,...t){l.addListener(m.get(n),...t)},hasListener(l,n){return l.hasListener(m.get(n))},removeListener(l,n){l.removeListener(m.get(n))}}),S=new a(m=>typeof m!="function"?m:function(n){const t=w(n,{},{getContent:{minArgs:0,maxArgs:0}});m(t)}),F=new a(m=>typeof m!="function"?m:function(n,t,c){let f=!1,p,A=new Promise(y=>{p=function(E){f=!0,y(E)}}),h;try{h=m(n,t,p)}catch(y){h=Promise.reject(y)}const g=h!==!0&&x(h);if(h!==!0&&!g&&!f)return!1;const C=y=>{y.then(E=>{c(E)},E=>{let R;E&&(E instanceof Error||typeof E.message=="string")?R=E.message:R="An unexpected error occurred",c({__mozWebExtensionPolyfillReject__:!0,message:R})}).catch(E=>{console.error("Failed to send onMessage rejected reply",E)})};return C(g?h:A),!0}),D=({reject:m,resolve:l},n)=>{i.runtime.lastError?i.runtime.lastError.message===u?l():m(new Error(i.runtime.lastError.message)):n&&n.__mozWebExtensionPolyfillReject__?m(new Error(n.message)):l(n)},O=(m,l,n,...t)=>{if(t.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${b(l.minArgs)} for ${m}(), got ${t.length}`);if(t.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${b(l.maxArgs)} for ${m}(), got ${t.length}`);return new Promise((c,f)=>{const p=D.bind(null,{resolve:c,reject:f});t.push(p),n.sendMessage(...t)})},ne={devtools:{network:{onRequestFinished:T(S)}},runtime:{onMessage:T(F),onMessageExternal:T(F),sendMessage:O.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:O.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},U={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return o.privacy={network:{"*":U},services:{"*":U},websites:{"*":U}},w(i,ne,o)};r.exports=d(chrome)}})})(fe);var Fe=fe.exports;const M=K(Fe);let re=null;M.runtime.onInstalled.addListener(async({reason:e})=>{M.contextMenus.create({id:"toNote",title:"Add to note",contexts:["selection"]}),M.contextMenus.onClicked.addListener((s,r)=>{console.log("try to send msg from context bckg to CS:",s),s.menuItemId=="toNote"&&M.tabs.query({active:!0,currentWindow:!0}).then(u=>{M.tabs.sendMessage(u[0].id,{action:"copyToNote",info:s})})}),e==="install"&&await M.tabs.create({url:M.runtime.getURL("/welcome.html"),active:!0})});async function De(e){try{const r=await(await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${e}`}})).json();console.log("UserProfileData:",r),await M.storage.local.set({user:r})}catch(s){console.error(s)}}const Le=xe(()=>{de("startGoogleAuthFlow",async({data:e,sender:s})=>{let r=null;try{const u=await Be();console.log("Received message in background:",e,s),console.log("Google authentication response:",u);let d=new URL(u);const i=new URLSearchParams(d==null?void 0:d.hash.replace("#","")),o=i.get("access_token");return o&&De(o),re={success:!0,receivedData:o},console.log("params: ",i),re}catch(u){return console.error("Authentication failed:",u),{success:!1,receivedData:r}}}),de("fetch-response-cache",async()=>re)});async function Be(){const u=`https://accounts.google.com/o/oauth2/auth?client_id=${encodeURIComponent("633211872171-b2qqc29i8dh7g67t2lrfpo4j83kkjsda.apps.googleusercontent.com")}&redirect_uri=https://ffbmjgghjjikoipblghlgbhnoghpnkij.chromiumapp.org&response_type=token&scope=${encodeURIComponent("https://www.googleapis.com/auth/userinfo.profile")}`;try{const d=await M.identity.launchWebAuthFlow({url:u,interactive:!0});return console.log("Authentication result:",d),await M.tabs.create({url:M.runtime.getURL("/welcome.html"),active:!0}),d}catch(d){throw console.error("Error during Google authentication:",d),d}}function ze(){}function H(e,...s){}const Ue={debug:(...e)=>H(console.debug,...e),log:(...e)=>H(console.log,...e),warn:(...e)=>H(console.warn,...e),error:(...e)=>H(console.error,...e)};let se;try{se=Le.main(),se instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw Ue.error("The background crashed on startup!"),e}return se}();
background;
