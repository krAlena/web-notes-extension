var background=function(){"use strict";function fe(e){return e==null||typeof e=="function"?{main:e}:e}var te=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var K={exports:{}};const xe=e=>typeof crypto<"u"&&typeof crypto.getRandomValues=="function"?()=>{const s=crypto.getRandomValues(new Uint8Array(1))[0];return(s>=e?s%e:s).toString(e)}:()=>Math.floor(Math.random()*e).toString(e),ie=(e=7,s=!1)=>Array.from({length:e},xe(s?16:36)).join("");K.exports=ie,K.exports.default=ie;var pe=K.exports;const q=H(pe);var be=()=>`uid::${q(7)}`,he=(e,s=["endpointName","fingerprint"])=>typeof e=="object"&&e!==null&&s.every(r=>r in e),we=e=>{try{const s=JSON.parse(e);return he(s)?s:null}catch{return null}},ye=()=>{let e=[];return{add:(...s)=>{e=[...e,...s]},remove:s=>{e=typeof s=="string"?e.filter(r=>r.message.transactionId!==s):e.filter(r=>!s.includes(r))},entries:()=>e}},U=class{static toBackground(e,s){return e.postMessage(s)}static toExtensionContext(e,s){return e.postMessage(s)}},ve=Object.defineProperty,ke=Object.defineProperties,Ee=Object.getOwnPropertyDescriptors,oe=Object.getOwnPropertySymbols,Ce=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,ae=(e,s,r)=>s in e?ve(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,R=(e,s)=>{for(var r in s||(s={}))Ce.call(s,r)&&ae(e,r,s[r]);if(oe)for(var r of oe(s))Te.call(s,r)&&ae(e,r,s[r]);return e},Y=(e,s)=>ke(e,Ee(s)),Se=/^((?:background$)|devtools|popup|options|content-script|window)(?:@(\d+)(?:\.(\d+))?)?$/,Q=e=>{const[,s,r,d]=e.match(Se)||[];return{context:s,tabId:+r,frameId:d?+d:void 0}},z=({context:e,tabId:s,frameId:r})=>["background","popup","options"].includes(e)?e:`${e}@${s}${r?`.${r}`:""}`;const _e=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],X=Symbol(".toJSON was called"),Pe=e=>{e[X]=!0;const s=e.toJSON();return delete e[X],s},ge=({from:e,seen:s,to_:r,forceEnumerable:d,maxDepth:u,depth:o})=>{const i=r||(Array.isArray(e)?[]:{});if(s.push(e),o>=u)return i;if(typeof e.toJSON=="function"&&e[X]!==!0)return Pe(e);for(const[a,x]of Object.entries(e)){if(typeof Buffer=="function"&&Buffer.isBuffer(x)){i[a]="[object Buffer]";continue}if(x!==null&&typeof x=="object"&&typeof x.pipe=="function"){i[a]="[object Stream]";continue}if(typeof x!="function"){if(!x||typeof x!="object"){i[a]=x;continue}if(!s.includes(e[a])){o++,i[a]=ge({from:e[a],seen:[...s],forceEnumerable:d,maxDepth:u,depth:o});continue}i[a]="[Circular]"}}for(const{property:a,enumerable:x}of _e)typeof e[a]=="string"&&Object.defineProperty(i,a,{value:e[a],enumerable:d?!0:x,configurable:!0,writable:!0});return i};function Me(e,s={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=s;return typeof e=="object"&&e!==null?ge({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}let me=()=>({events:{},emit(e,...s){(this.events[e]||[]).forEach(r=>r(...s))},on(e,s){return(this.events[e]=this.events[e]||[]).push(s),()=>this.events[e]=(this.events[e]||[]).filter(r=>r!==s)}});var Ie=(e,s,r)=>{const d=q(),u=new Map,o=new Map,i=a=>{if(a.destination.context===e&&!a.destination.frameId&&!a.destination.tabId){r==null||r(a);const{transactionId:x,messageID:k,messageType:b}=a,_=()=>{const v=u.get(x);if(v){const{err:w,data:T}=a;if(w){const S=w,j=self[S.name],F=new(typeof j=="function"?j:Error)(S.message);for(const $ in S)F[$]=S[$];v.reject(F)}else v.resolve(T);u.delete(x)}},M=async()=>{let v,w,T=!1;try{const S=o.get(k);if(typeof S=="function")v=await S({sender:a.origin,id:k,data:a.data,timestamp:a.timestamp});else throw T=!0,new Error(`[webext-bridge] No handler registered in '${e}' to accept messages with id '${k}'`)}catch(S){w=S}finally{if(w&&(a.err=Me(w)),i(Y(R({},a),{messageType:"reply",data:v,origin:{context:e,tabId:null},destination:a.origin,hops:[]})),w&&!T)throw v}};switch(b){case"reply":return _();case"message":return M()}}return a.hops.push(`${e}::${d}`),s(a)};return{handleMessage:i,endTransaction:a=>{const x=u.get(a);x==null||x.reject("Transaction was ended before it could complete"),u.delete(a)},sendMessage:(a,x,k="background")=>{const b=typeof k=="string"?Q(k):k,_="Bridge#sendMessage ->";if(!b.context)throw new TypeError(`${_} Destination must be any one of known destinations`);return new Promise((M,v)=>{const w={messageID:a,data:x,destination:b,messageType:"message",transactionId:q(),origin:{context:e,tabId:null},hops:[],timestamp:Date.now()};u.set(w.transactionId,{resolve:M,reject:v});try{i(w)}catch(T){u.delete(w.transactionId),v(T)}})},onMessage:(a,x)=>(o.set(a,x),()=>o.delete(a))}},D=class{constructor(e,s){this.endpointRuntime=e,this.streamInfo=s,this.emitter=me(),this.isClosed=!1,this.handleStreamClose=()=>{this.isClosed||(this.isClosed=!0,this.emitter.emit("closed",!0),this.emitter.events={})},D.initDone||(e.onMessage("__crx_bridge_stream_transfer__",r=>{const{streamId:d,streamTransfer:u,action:o}=r.data,i=D.openStreams.get(d);i&&!i.isClosed&&(o==="transfer"&&i.emitter.emit("message",u),o==="close"&&(D.openStreams.delete(d),i.handleStreamClose()))}),D.initDone=!0),D.openStreams.set(this.streamInfo.streamId,this)}get info(){return this.streamInfo}send(e){if(this.isClosed)throw new Error("Attempting to send a message over closed stream. Use stream.onClose(<callback>) to keep an eye on stream status");this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:e,action:"transfer"},this.streamInfo.endpoint)}close(e){e&&this.send(e),this.handleStreamClose(),this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:null,action:"close"},this.streamInfo.endpoint)}onMessage(e){return this.getDisposable("message",e)}onClose(e){return this.getDisposable("closed",e)}getDisposable(e,s){const r=this.emitter.on(e,s);return Object.assign(r,{dispose:r,close:r})}},G=D;G.initDone=!1,G.openStreams=new Map;var Ne=e=>{const s=new Map,r=new Map,d=me();e.onMessage("__crx_bridge_stream_open__",i=>new Promise(a=>{const{sender:x,data:k}=i,{channel:b}=k;let _=!1,M=()=>{};const v=()=>{const w=r.get(b);typeof w=="function"?(w(new G(e,Y(R({},k),{endpoint:x}))),_&&M(),a(!0)):_||(_=!0,M=d.on("did-change-stream-callbacks",v))};v()}));async function u(i,a){if(s.has(i))throw new Error("webext-bridge: A Stream is already open at this channel");const x=typeof a=="string"?Q(a):a,k={streamId:q(),channel:i,endpoint:x},b=new G(e,k);return b.onClose(()=>s.delete(i)),await e.sendMessage("__crx_bridge_stream_open__",k,x),s.set(i,b),b}function o(i,a){if(r.has(i))throw new Error("webext-bridge: This channel has already been claimed. Stream allows only one-on-one communication");r.set(i,a),d.emit("did-change-stream-callbacks")}return{openStream:u,onOpenStreamChannel:o}},le={exports:{}};(function(e,s){(function(r,d){d(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:te,function(r){if(typeof globalThis!="object"||typeof chrome!="object"||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const d="The message port closed before a response was received.",u="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",o=i=>{const a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(a).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class x extends WeakMap{constructor(t,c=void 0){super(c),this.createItem=t}get(t){return this.has(t)||this.set(t,this.createItem(t)),super.get(t)}}const k=n=>n&&typeof n=="object"&&typeof n.then=="function",b=(n,t)=>(...c)=>{i.runtime.lastError?n.reject(new Error(i.runtime.lastError.message)):t.singleCallbackArg||c.length<=1&&t.singleCallbackArg!==!1?n.resolve(c[0]):n.resolve(c)},_=n=>n==1?"argument":"arguments",M=(n,t)=>function(f,...p){if(p.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${_(t.minArgs)} for ${n}(), got ${p.length}`);if(p.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${_(t.maxArgs)} for ${n}(), got ${p.length}`);return new Promise((A,h)=>{if(t.fallbackToNoCallback)try{f[n](...p,b({resolve:A,reject:h},t))}catch(g){console.warn(`${n} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,g),f[n](...p),t.fallbackToNoCallback=!1,t.noCallback=!0,A()}else t.noCallback?(f[n](...p),A()):f[n](...p,b({resolve:A,reject:h},t))})},v=(n,t,c)=>new Proxy(t,{apply(f,p,A){return c.call(p,n,...A)}});let w=Function.call.bind(Object.prototype.hasOwnProperty);const T=(n,t={},c={})=>{let f=Object.create(null),p={has(h,g){return g in n||g in f},get(h,g,E){if(g in f)return f[g];if(!(g in n))return;let y=n[g];if(typeof y=="function")if(typeof t[g]=="function")y=v(n,n[g],t[g]);else if(w(c,g)){let C=M(g,c[g]);y=v(n,n[g],C)}else y=y.bind(n);else if(typeof y=="object"&&y!==null&&(w(t,g)||w(c,g)))y=T(y,t[g],c[g]);else if(w(c,"*"))y=T(y,t[g],c["*"]);else return Object.defineProperty(f,g,{configurable:!0,enumerable:!0,get(){return n[g]},set(C){n[g]=C}}),y;return f[g]=y,y},set(h,g,E,y){return g in f?f[g]=E:n[g]=E,!0},defineProperty(h,g,E){return Reflect.defineProperty(f,g,E)},deleteProperty(h,g){return Reflect.deleteProperty(f,g)}},A=Object.create(n);return new Proxy(A,p)},S=n=>({addListener(t,c,...f){t.addListener(n.get(c),...f)},hasListener(t,c){return t.hasListener(n.get(c))},removeListener(t,c){t.removeListener(n.get(c))}}),j=new x(n=>typeof n!="function"?n:function(c){const f=T(c,{},{getContent:{minArgs:0,maxArgs:0}});n(f)});let F=!1;const $=new x(n=>typeof n!="function"?n:function(c,f,p){let A=!1,h,g=new Promise(N=>{h=function(I){F||(console.warn(u,new Error().stack),F=!0),A=!0,N(I)}}),E;try{E=n(c,f,h)}catch(N){E=Promise.reject(N)}const y=E!==!0&&k(E);if(E!==!0&&!y&&!A)return!1;const C=N=>{N.then(I=>{p(I)},I=>{let ne;I&&(I instanceof Error||typeof I.message=="string")?ne=I.message:ne="An unexpected error occurred",p({__mozWebExtensionPolyfillReject__:!0,message:ne})}).catch(I=>{console.error("Failed to send onMessage rejected reply",I)})};return C(y?E:g),!0}),se=({reject:n,resolve:t},c)=>{i.runtime.lastError?i.runtime.lastError.message===d?t():n(new Error(i.runtime.lastError.message)):c&&c.__mozWebExtensionPolyfillReject__?n(new Error(c.message)):t(c)},B=(n,t,c,...f)=>{if(f.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${_(t.minArgs)} for ${n}(), got ${f.length}`);if(f.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${_(t.maxArgs)} for ${n}(), got ${f.length}`);return new Promise((p,A)=>{const h=se.bind(null,{resolve:p,reject:A});f.push(h),c.sendMessage(...f)})},m={devtools:{network:{onRequestFinished:S(j)}},runtime:{onMessage:S($),onMessageExternal:S($),sendMessage:B.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:B.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},l={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":l},services:{"*":l},websites:{"*":l}},T(i,m,a)};r.exports=o(chrome)}else r.exports=globalThis.browser})})(le);var Re=le.exports;const $e=H(Re);var W=ye(),P=new Map,L=new Map,V=new Map,ce=(e,s)=>(L.set(e,(L.get(e)||new Set).add(s)),()=>{const r=L.get(e);r!=null&&r.delete(s)&&(r==null?void 0:r.size)===0&&L.delete(e)}),Ae=(e,s)=>{V.set(e,(V.get(e)||new Set).add(s))},O=e=>({withFingerprint:s=>{const r=u=>({and:()=>u}),d={aboutIncomingMessage:u=>{const o=P.get(e);return U.toExtensionContext(o.port,{status:"incoming",message:u}),r(d)},aboutSuccessfulDelivery:u=>{const o=P.get(e);return U.toExtensionContext(o.port,{status:"delivered",receipt:u}),r(d)},aboutMessageUndeliverability:(u,o)=>{const i=P.get(e);return(i==null?void 0:i.fingerprint)===s&&U.toExtensionContext(i.port,{status:"undeliverable",resolvedDestination:u,message:o}),r(d)},whenDeliverableTo:u=>{const o=()=>{const i=P.get(e);if((i==null?void 0:i.fingerprint)===s&&P.has(u))return U.toExtensionContext(i.port,{status:"deliverable",deliverableTo:u}),!0};if(!o()){const i=ce(u,o);Ae(s,i)}return r(d)},aboutSessionEnded:u=>{const o=P.get(e);return(o==null?void 0:o.fingerprint)===s&&U.toExtensionContext(o.port,{status:"terminated",fingerprint:u}),r(d)}};return d}}),Oe=be(),Z=Ie("background",e=>{var s;if(e.origin.context==="background"&&["content-script","devtools "].includes(e.destination.context)&&!e.destination.tabId)throw new TypeError("When sending messages from background page, use @tabId syntax to target specific tab");const r=z(R(R({},e.origin),e.origin.context==="window"&&{context:"content-script"})),d=z(Y(R(R({},e.destination),e.destination.context==="window"&&{context:"content-script"}),{tabId:e.destination.tabId||e.origin.tabId}));e.destination.tabId=null,e.destination.frameId=null;const u=()=>P.get(d),o=()=>P.get(r),i=()=>{var a;O(d).withFingerprint(u().fingerprint).aboutIncomingMessage(e);const x={message:e,to:u().fingerprint,from:{endpointId:r,fingerprint:(a=o())==null?void 0:a.fingerprint}};e.messageType==="message"&&W.add(x),e.messageType==="reply"&&W.remove(e.messageID),o()&&O(r).withFingerprint(o().fingerprint).aboutSuccessfulDelivery(x)};(s=u())!=null&&s.port?i():e.messageType==="message"&&(e.origin.context==="background"?ce(d,i):o()&&O(r).withFingerprint(o().fingerprint).aboutMessageUndeliverability(d,e).and().whenDeliverableTo(d))},e=>{const s=z(R(R({},e.origin),e.origin.context==="window"&&{context:"content-script"})),r=P.get(s),d={message:e,to:Oe,from:{endpointId:s,fingerprint:r.fingerprint}};O(s).withFingerprint(r.fingerprint).aboutSuccessfulDelivery(d)});$e.runtime.onConnect.addListener(e=>{var s;const r=we(e.name);if(!r)return;r.endpointName||(r.endpointName=z({context:"content-script",tabId:e.sender.tab.id,frameId:e.sender.frameId}));const{tabId:d,frameId:u}=Q(r.endpointName);P.set(r.endpointName,{fingerprint:r.fingerprint,port:e}),(s=L.get(r.endpointName))==null||s.forEach(o=>o()),L.delete(r.endpointName),Ae(r.fingerprint,()=>{const o=W.entries().filter(i=>i.to===r.fingerprint);W.remove(o),o.forEach(i=>{i.from.endpointId==="background"?Z.endTransaction(i.message.transactionId):O(i.from.endpointId).withFingerprint(i.from.fingerprint).aboutSessionEnded(r.fingerprint)})}),e.onDisconnect.addListener(()=>{var o,i;((o=P.get(r.endpointName))==null?void 0:o.fingerprint)===r.fingerprint&&P.delete(r.endpointName),(i=V.get(r.fingerprint))==null||i.forEach(a=>a()),V.delete(r.fingerprint)}),e.onMessage.addListener(o=>{var i,a;if(o.type==="sync"){const x=[...P.values()].map(b=>b.fingerprint),k=o.pendingResponses.filter(b=>x.includes(b.to));W.add(...k),o.pendingResponses.filter(b=>!x.includes(b.to)).forEach(b=>O(r.endpointName).withFingerprint(r.fingerprint).aboutSessionEnded(b.to)),o.pendingDeliveries.forEach(b=>O(r.endpointName).withFingerprint(r.fingerprint).whenDeliverableTo(b));return}o.type==="deliver"&&((a=(i=o.message)==null?void 0:i.origin)!=null&&a.context)&&(o.message.origin.tabId=d,o.message.origin.frameId=u,Z.handleMessage(o.message))})});var{sendMessage:Ue,onMessage:ue}=Z;Ne(Z);var de={exports:{}};(function(e,s){(function(r,d){d(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:te,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const d="The message port closed before a response was received.",u=o=>{const i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(i).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(l,n=void 0){super(n),this.createItem=l}get(l){return this.has(l)||this.set(l,this.createItem(l)),super.get(l)}}const x=m=>m&&typeof m=="object"&&typeof m.then=="function",k=(m,l)=>(...n)=>{o.runtime.lastError?m.reject(new Error(o.runtime.lastError.message)):l.singleCallbackArg||n.length<=1&&l.singleCallbackArg!==!1?m.resolve(n[0]):m.resolve(n)},b=m=>m==1?"argument":"arguments",_=(m,l)=>function(t,...c){if(c.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${b(l.minArgs)} for ${m}(), got ${c.length}`);if(c.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${b(l.maxArgs)} for ${m}(), got ${c.length}`);return new Promise((f,p)=>{if(l.fallbackToNoCallback)try{t[m](...c,k({resolve:f,reject:p},l))}catch(A){console.warn(`${m} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,A),t[m](...c),l.fallbackToNoCallback=!1,l.noCallback=!0,f()}else l.noCallback?(t[m](...c),f()):t[m](...c,k({resolve:f,reject:p},l))})},M=(m,l,n)=>new Proxy(l,{apply(t,c,f){return n.call(c,m,...f)}});let v=Function.call.bind(Object.prototype.hasOwnProperty);const w=(m,l={},n={})=>{let t=Object.create(null),c={has(p,A){return A in m||A in t},get(p,A,h){if(A in t)return t[A];if(!(A in m))return;let g=m[A];if(typeof g=="function")if(typeof l[A]=="function")g=M(m,m[A],l[A]);else if(v(n,A)){let E=_(A,n[A]);g=M(m,m[A],E)}else g=g.bind(m);else if(typeof g=="object"&&g!==null&&(v(l,A)||v(n,A)))g=w(g,l[A],n[A]);else if(v(n,"*"))g=w(g,l[A],n["*"]);else return Object.defineProperty(t,A,{configurable:!0,enumerable:!0,get(){return m[A]},set(E){m[A]=E}}),g;return t[A]=g,g},set(p,A,h,g){return A in t?t[A]=h:m[A]=h,!0},defineProperty(p,A,h){return Reflect.defineProperty(t,A,h)},deleteProperty(p,A){return Reflect.deleteProperty(t,A)}},f=Object.create(m);return new Proxy(f,c)},T=m=>({addListener(l,n,...t){l.addListener(m.get(n),...t)},hasListener(l,n){return l.hasListener(m.get(n))},removeListener(l,n){l.removeListener(m.get(n))}}),S=new a(m=>typeof m!="function"?m:function(n){const t=w(n,{},{getContent:{minArgs:0,maxArgs:0}});m(t)}),j=new a(m=>typeof m!="function"?m:function(n,t,c){let f=!1,p,A=new Promise(y=>{p=function(C){f=!0,y(C)}}),h;try{h=m(n,t,p)}catch(y){h=Promise.reject(y)}const g=h!==!0&&x(h);if(h!==!0&&!g&&!f)return!1;const E=y=>{y.then(C=>{c(C)},C=>{let N;C&&(C instanceof Error||typeof C.message=="string")?N=C.message:N="An unexpected error occurred",c({__mozWebExtensionPolyfillReject__:!0,message:N})}).catch(C=>{console.error("Failed to send onMessage rejected reply",C)})};return E(g?h:A),!0}),F=({reject:m,resolve:l},n)=>{o.runtime.lastError?o.runtime.lastError.message===d?l():m(new Error(o.runtime.lastError.message)):n&&n.__mozWebExtensionPolyfillReject__?m(new Error(n.message)):l(n)},$=(m,l,n,...t)=>{if(t.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${b(l.minArgs)} for ${m}(), got ${t.length}`);if(t.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${b(l.maxArgs)} for ${m}(), got ${t.length}`);return new Promise((c,f)=>{const p=F.bind(null,{resolve:c,reject:f});t.push(p),n.sendMessage(...t)})},se={devtools:{network:{onRequestFinished:T(S)}},runtime:{onMessage:T(j),onMessageExternal:T(j),sendMessage:$.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:$.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},B={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":B},services:{"*":B},websites:{"*":B}},w(o,se,i)};r.exports=u(chrome)}})})(de);var je=de.exports;const Fe=H(je);let ee=null;const De=fe(()=>{ue("startGoogleAuthFlow",async({data:e,sender:s})=>{let r=null;try{const d=await Le();console.log("Received message in background:",e,s),console.log("Google authentication response:",d);let u=new URL(d);const o=new URLSearchParams(u==null?void 0:u.hash.replace("#",""));return r=o.get("access_token"),ee={success:!0,receivedData:r},console.log("params: ",o),ee}catch(d){return console.error("Authentication failed:",d),{success:!1,receivedData:r}}}),ue("fetch-response-cache",async()=>ee)});async function Le(){const d=`https://accounts.google.com/o/oauth2/auth?client_id=${encodeURIComponent("633211872171-b2qqc29i8dh7g67t2lrfpo4j83kkjsda.apps.googleusercontent.com")}&redirect_uri=https://ffbmjgghjjikoipblghlgbhnoghpnkij.chromiumapp.org&response_type=token&scope=${encodeURIComponent("https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/keep")}`;try{const u=await Fe.identity.launchWebAuthFlow({url:d,interactive:!0});return console.log("Authentication result:",u),u}catch(u){throw console.error("Error during Google authentication:",u),u}}function qe(){}function J(e,...s){}const Be={debug:(...e)=>J(console.debug,...e),log:(...e)=>J(console.log,...e),warn:(...e)=>J(console.warn,...e),error:(...e)=>J(console.error,...e)};let re;try{re=De.main(),re instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw Be.error("The background crashed on startup!"),e}return re}();
background;
